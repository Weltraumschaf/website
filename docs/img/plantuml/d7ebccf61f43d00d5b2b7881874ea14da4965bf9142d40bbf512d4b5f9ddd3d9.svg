<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="501px" preserveAspectRatio="none" style="width:765px;height:501px;" version="1.1" viewBox="0 0 765 501" width="765px" zoomAndPan="magnify"><defs/><g><rect fill="#F0F0FF" height="470.5859" style="stroke: #FFFFFF; stroke-width: 1.0;" width="300.5" x="400" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="536.25" y="16.0669">RS1</text><line style="stroke: #AAAAAA; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="43" x2="43" y1="54.4297" y2="440.2891"/><line style="stroke: #AAAAAA; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="218" x2="218" y1="54.4297" y2="440.2891"/><line style="stroke: #AAAAAA; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="346.5" x2="346.5" y1="54.4297" y2="440.2891"/><line style="stroke: #AAAAAA; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="437" x2="437" y1="54.4297" y2="440.2891"/><line style="stroke: #AAAAAA; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="650.5" x2="650.5" y1="54.4297" y2="440.2891"/><line style="stroke: #AAAAAA; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="727.5" x2="727.5" y1="54.4297" y2="440.2891"/><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="71" x="8" y="23.1328"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="15" y="43.1279">Browser</text><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="71" x="8" y="439.2891"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="15" y="459.2842">Browser</text><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="85" x="176" y="23.1328"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="183" y="43.1279">client.com</text><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="85" x="176" y="439.2891"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="183" y="459.2842">client.com</text><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="32" x="330.5" y="23.1328"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="337.5" y="43.1279">AS</text><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="32" x="330.5" y="439.2891"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="18" x="337.5" y="459.2842">AS</text><rect fill="#F08080" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="67" x="404" y="23.1328"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="411" y="43.1279">RS1TLS</text><rect fill="#F08080" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="67" x="404" y="439.2891"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="411" y="459.2842">RS1TLS</text><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="92" x="604.5" y="23.1328"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="611.5" y="43.1279">RS1Service</text><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="92" x="604.5" y="439.2891"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="611.5" y="459.2842">RS1Service</text><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="42" x="706.5" y="23.1328"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="713.5" y="43.1279">RS2</text><rect fill="#375A7F" height="30.2969" style="stroke: #375A7F; stroke-width: 1.5;" width="42" x="706.5" y="439.2891"/><text fill="#FFFFFF" font-family="Roboto" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="713.5" y="459.2842">RS2</text><polygon fill="#375A7F" points="206.5,81.5625,216.5,85.5625,206.5,89.5625,210.5,85.5625" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="43.5" x2="212.5" y1="85.5625" y2="85.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="32" x="50.5" y="80.4966">Start</text><polygon fill="#375A7F" points="54.5,110.6953,44.5,114.6953,54.5,118.6953,50.5,114.6953" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="48.5" x2="217.5" y1="114.6953" y2="114.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="60.5" y="109.6294">Authz Request</text><polygon fill="#375A7F" points="334.5,139.8281,344.5,143.8281,334.5,147.8281,338.5,143.8281" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="43.5" x2="340.5" y1="143.8281" y2="143.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="50.5" y="138.7622">Authz Request</text><polygon fill="#375A7F" points="54.5,168.9609,44.5,172.9609,54.5,176.9609,50.5,172.9609" style="stroke: #375A7F; stroke-width: 1.0;"/><polygon fill="#375A7F" points="334.5,168.9609,344.5,172.9609,334.5,176.9609,338.5,172.9609" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="48.5" x2="340.5" y1="172.9609" y2="172.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="60.5" y="167.895">authn, authz</text><polygon fill="#375A7F" points="54.5,198.0938,44.5,202.0938,54.5,206.0938,50.5,202.0938" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="48.5" x2="345.5" y1="202.0938" y2="202.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="60.5" y="197.0278">Authorization Response</text><polygon fill="#375A7F" points="206.5,227.2266,216.5,231.2266,206.5,235.2266,210.5,231.2266" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="43.5" x2="212.5" y1="231.2266" y2="231.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="50.5" y="226.1606">Authorization Response</text><polygon fill="#375A7F" points="334.5,256.3594,344.5,260.3594,334.5,264.3594,338.5,260.3594" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="218.5" x2="340.5" y1="260.3594" y2="260.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="225.5" y="255.2935">Token Request</text><polygon fill="#375A7F" points="229.5,285.4922,219.5,289.4922,229.5,293.4922,225.5,289.4922" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="223.5" x2="345.5" y1="289.4922" y2="289.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="235.5" y="284.4263">Token Response</text><polygon fill="#375A7F" points="425.5,329.7578,435.5,333.7578,425.5,337.7578,429.5,333.7578" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="218.5" x2="431.5" y1="333.7578" y2="333.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="225.5" y="313.5591">POST https://rs1.com/resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="225.5" y="328.6919">Authorization:</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="318.5" y="328.6919">Bearer 42xyz...</text><polygon fill="#375A7F" points="638.5,374.0234,648.5,378.0234,638.5,382.0234,642.5,378.0234" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="437.5" x2="644.5" y1="378.0234" y2="378.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="444.5" y="357.8247">POST http://service/resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="444.5" y="372.9575">Authorization:</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="537.5" y="372.9575">Bearer 42xyz...</text><polygon fill="#375A7F" points="715.5,418.2891,725.5,422.2891,715.5,426.2891,719.5,422.2891" style="stroke: #375A7F; stroke-width: 1.0;"/><line style="stroke: #375A7F; stroke-width: 1.0;" x1="437.5" x2="721.5" y1="422.2891" y2="422.2891"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="444.5" y="402.0903">POST https://rs2.com/resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="444.5" y="417.2231">Authorization:</text><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="537.5" y="417.2231">Bearer 42xyz...</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacingAndGlyphs" textLength="61" x="692.5" y="487.8682">danielfett.de</text><!--MD5=[1249fac531e165e6ad564b7b08d5e5bb]
@startuml
hide stereotype
skinparam shadowing false
skinparam sequence {
ArrowColor #375a7f
LifeLineBorderColor #aaa
BoundaryBackgroundColor #f00

ParticipantBorderColor #375a7f
ParticipantBackgroundColor #375a7f
ParticipantFontColor #fff
ParticipantFontName Roboto
ParticipantFontSize 14

BoxBackgroundColor #f0f0ff
BoxBorderColor transparent
ParticipantBackgroundColor<<Attacker>> #F08080
}

skinparam note {
BackgroundColor #CEE1F5
BorderColor #CEE1F5
FontColor #000

BackgroundColor<<warning>> #FFCEB5
BorderColor<<warning>> #FFCEB5

BackgroundColor<<ok>> #C6EAA6
BorderColor<<ok>> #C6EAA6
}

right footer danielfett.de
participant Browser
participant client.com
participant AS
box RS1
participant RS1TLS <<Attacker>>
participant RS1Service
end box 
participant RS2

Browser -> client.com: Start
client.com -> Browser: Authz Request
Browser -> AS: Authz Request
Browser <- -> AS: authn, authz
AS -> Browser: Authorization Response
Browser -> client.com: Authorization Response
client.com -> AS: Token Request
AS -> client.com: Token Response
client.com -> RS1TLS: POST https://rs1.com/resource\nAuthorization: <font color=blue>Bearer 42xyz...</font>
RS1TLS -> RS1Service: POST http://service/resource\nAuthorization: <font color=blue>Bearer 42xyz...</font>
RS1TLS -> RS2: <font color=red>POST https://rs2.com/resource</font>\nAuthorization: <font color=blue>Bearer 42xyz...</font>
@enduml

PlantUML version 1.2020.08(Sun Apr 26 14:08:22 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_252-b09
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>